<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hollysys.platform.auth.data.server.mapper.SysResourceMapper" >

    <select id="getResourcesByUserId" resultType="com.hollysys.platform.auth.data.api.entity.SysResources">
        select distinct
        sr.*
        from
        sys_resources as sr
        left join sys_role_resource as srr on srr.resource_id = sr.id
        where
        srr.role_id in (
        select
        sur.role_id
        from
        sys_user_role as sur
        where 1 = 1
        <if test="userId != null and userId != ''">
            and sur.user_id = #{userId}
        </if>
        )
    </select>
</mapper>